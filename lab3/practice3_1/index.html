<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Практика - My Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u041f\u0440\u0430\u043a\u0442\u0438\u043a\u0430";
        var mkdocs_page_input_path = "lab3\\practice3_1.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> My Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Лабораторная работа 1</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab1/ex1/">Упраженение 1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab1/ex2/">Упражнение 2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab1/ex3/">Упражнение 3</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab1/ex4/">Упраженение 4</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab1/ex5/">Упражнение 5</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Лабораторная работа 2</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab2/practice/">Практика </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab2/urls/">urls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab2/models/">models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab2/views/">views</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab2/forms/">forms</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Лабораторная работа 3</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Практика</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">Ссылка на практику здесь</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#31">Практика 3.1</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1">Упражнение 1</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2">Задание 2</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3">Задание 3</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api_description/">Описание API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../views/">Views</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../filters/">Filters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../models/">models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../serializers/">Serializers</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Лабораторная работа 4</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab4/practice_4/">Практика </a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab4/book_instances/">Экземпляры книг</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab4/login_registration/">Логин, регистрация обновление данных пользователя</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab4/reader/">Работа с читателями</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../lab4/statistics/">Страница со статистикой</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">My Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Лабораторная работа 3</li>
      <li class="breadcrumb-item active">Практика</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">Практика</h1>
<h3 id="_2">Ссылка на практику <a href="https://github.com/silfurberg/ITMO_ICT_WebDevelopment_2023-2024/tree/lab3/students/k33422/Ivenkova_Elizaveta/practice_3">здесь</a></h3>
<h2 id="31">Практика 3.1</h2>
<h3 id="1">Упражнение 1</h3>
<p>Напишите запрос на создание 6-7 новых автовладельцев и 5-6 автомобилей, каждому автовладельцу назначьте удостоверение и от 1 до 3 автомобилей. Задание можете выполнить либо в интерактивном режиме интерпретатора, либо в отдельном python-файле. Результатом должны стать запросы и отображение созданных объектов. </p>
<p>Код:</p>
<pre><code class="language-python">from project_first_app.models import  Car, UserOwner, CarOwn, OwnerLicence 


from django.contrib.auth import get_user_model
user_model = get_user_model()


c1 = Car(id=1, serial_number='AA001A', model='toyota', color='black')
c1.save()
c2 = Car(id=2, serial_number='AA002A', model='toyota', color='white')
c2.save()
c3 = Car(id=3, serial_number='AA003A', model='toyota', color='orange')
c3.save()
c4 = Car(id=4, serial_number='AA004A', model='ford', color='black')
c4.save()
c5 = Car(id=5, serial_number='AA005A', model='ford', color='white')
c5.save()
c6 = Car(id=6, serial_number='AA006A', model='ford', color='orange')

u1 = user_model(username='vasy001', first_name='Vasy', last_name='Pupkin', passport_number='00001000001')
u1.save()
u2 = user_model(username='vasy002', first_name='Ivan', last_name='Kotov', passport_number='00001000002')
u2.save()
u3 = user_model(username='vasy003', first_name='Vasy', last_name='Kozlov', passport_number='00001000003')
u3.save()
u4 = user_model(username='vasy004', first_name='Vasy', last_name='User', passport_number='00001000004')
u4.save()
u5 = user_model(username='vasy005', first_name='Jojo', last_name='Reference', passport_number='00001000005')
u5.save()
u6 = user_model(username='vasy006', first_name='Ivan', last_name='User', passport_number='00001000006')
u6.save()


car_own_list = [[u1, c1, '2022-11-01 00:00:00+03:00', '2022-11-04 00:00:00+03:00'],
                [u1, c2, '2022-11-01 00:00:00+03:00', '2022-11-04 00:00:00+03:00'],
                [u2, c1, '2022-11-04 00:00:00+03:00', '2022-11-10 00:00:00+03:00'],
                [u2, c2, '2022-11-04 00:00:00+03:00', '2022-11-10 00:00:00+03:00'],
                [u3, c3, '2022-11-01 00:00:00+03:00', '2022-11-04 00:00:00+03:00'],
                [u4, c3, '2022-11-04 00:00:00+03:00', '2022-11-10 00:00:00+03:00'],
                [u4, c4, '2022-11-01 00:00:00+03:00', '2022-11-04 00:00:00+03:00'],
                [u5, c4, '2022-11-04 00:00:00+03:00', '2022-11-10 00:00:00+03:00'],
                [u5, c5, '2022-11-01 00:00:00+03:00', '2022-11-04 00:00:00+03:00'],
                [u5, c6, '2022-11-04 00:00:00+03:00', '2022-11-10 00:00:00+03:00']]


for owner, car, start_date, end_date in car_own_list:
    print(car, owner)
    CarOwn(owner=owner, car=car, start_date=start_date, end_date=end_date).save()

for i, user in enumerate([u1, u2, u3, u4, u5, u6]):
    OwnerLicence(owner=user, Licence_number=f'000{i}', licence_type='default', issue_date='2022-11-01').save()
</code></pre>
<p>Результат:</p>
<pre><code class="language-python">Car.objects.all()
&lt;QuerySet [&lt;Car: AA001A&gt;, &lt;Car: AA002A&gt;, &lt;Car: AA003A&gt;, &lt;Car: AA004A&gt;, &lt;Car: AA005A&gt;]&gt;

UserOwner.objects.all()
&lt;QuerySet [&lt;UserOwner: vasy001&gt;, &lt;UserOwner: vasy002&gt;, 
            &lt;UserOwner: vasy003&gt;, &lt;UserOwner: vasy004&gt;, 
            &lt;UserOwner: vasy005&gt;, &lt;UserOwner: vasy006&gt;]&gt;


CarOwn.objects.all()
&lt;QuerySet [&lt;CarOwn: vasy001 AA001A 2022-10-31 2022-11-03&gt;, 
&lt;CarOwn: vasy001 AA002A 2022-10-31 2022-11-03&gt;, 
&lt;CarOwn: vasy002 AA001A 2022-11-03 2022-11-09&gt;, 
&lt;CarOwn: vasy002 AA002A 2022-11-03 2022-11-09&gt;,
&lt;CarOwn: vasy003 AA003A 2022-10-31 2022-11-03&gt;,
&lt;CarOwn: vasy004 AA003A 2022-11-03 2022-11-09&gt;, 
&lt;CarOwn: vasy004 AA004A 2022-10-31 2022-11-03&gt;, 
&lt;CarOwn: vasy005 AA004A 2022-11-03 2022-11-09&gt;,
&lt;CarOwn: vasy005 AA005A 2022-10-31 2022-11-03&gt;]&gt;
</code></pre>
<h3 id="2">Задание 2</h3>
<p>Выведете все машины марки “Toyota” (или любой другой марки, которая у вас есть)</p>
<pre><code class="language-python">Car.objects.filter(model='ford')

&lt;QuerySet [&lt;Car: AA004A&gt;, &lt;Car: AA005A&gt;]&gt;
</code></pre>
<p>Найти всех водителей с именем “Олег” (или любым другим именем на ваше усмотрение)</p>
<pre><code class="language-python">UserOwner.objects.filter(first_name='Vasy')

&lt;QuerySet [&lt;UserOwner: vasy001&gt;, &lt;UserOwner: vasy003&gt;, &lt;UserOwner: vasy004&gt;]&gt;
</code></pre>
<p>Взяв любого случайного владельца получить его id, и по этому id получить экземпляр удостоверения в виде объекта модели (можно в 2 запроса)</p>
<pre><code class="language-python">from random import choice
rand_user = choice(user_model.objects.all())
_id = rand_user.id
licence = rand_user.owner_licence.get()
licence

&lt;OwnerLicence: vasy003 0002&gt;
</code></pre>
<p>Вывести всех владельцев красных машин (или любого другого цвета, который у вас присутствует)</p>
<pre><code class="language-python">UserOwner.objects.filter(owner_car__car__color='black')
UserOwner.objects.filter(cars__color='black')

&lt;QuerySet [&lt;UserOwner: vasy001&gt;, &lt;UserOwner: vasy002&gt;, &lt;UserOwner: vasy004&gt;, &lt;UserOwner: vasy005&gt;]&gt;
</code></pre>
<p>Найти всех владельцев, чей год владения машиной начинается с 2010 (или любой другой год, который присутствует у вас в базе)</p>
<pre><code class="language-python">UserOwner.objects.filter(owner_car__start_date__year='2022').distinct()

&lt;QuerySet [&lt;UserOwner: vasy001&gt;, &lt;UserOwner: vasy002&gt;, &lt;UserOwner: vasy003&gt;, &lt;UserOwner: vasy004&gt;, &lt;UserOwner: vasy005&gt;]&gt;
</code></pre>
<h3 id="3">Задание 3</h3>
<p>Вывод даты выдачи самого старшего водительского удостоверения</p>
<pre><code class="language-python">OwnerLicence.objects.aggregate(max_issue_date = models.Max('issue_date'))
{'max_issue_date': datetime.date(2022, 11, 1)}
</code></pre>
<p>Укажите самую позднюю дату владения машиной, имеющую какую-то из существующих моделей в вашей базе</p>
<pre><code class="language-python">CarOwn.objects.aggregate(latest_start_date=models.Max('start_date'))
{'latest_start_date': datetime.datetime(2022, 11, 3, 21, 0, tzinfo=datetime.timezone.utc)}
</code></pre>
<p>Выведите количество машин для каждого водителя</p>
<pre><code class="language-python">count_by_user = UserOwner.objects.annotate(count=models.Count('owner_car'))
for user_count in count_by_user:
    print(user_count.username, user_count.count)

vsevolod026 0
vasy001 2
vasy002 2
vasy003 1
vasy004 2
vasy005 2
vasy006 0

</code></pre>
<p>Подсчитайте количество машин каждой марки</p>
<pre><code class="language-python">count_by_model = Car.objects.values('model').annotate(count=models.Count('id'))
for model_counter in count_by_model:
    print(model_counter['model'], model_counter['count'])

ford 2
toyota 3
</code></pre>
<p>Отсортируйте всех автовладельцев по дате выдачи удостоверения </p>
<pre><code class="language-python">OwnerLicence.objects.order_by('issue_date')
&lt;QuerySet [&lt;OwnerLicence: vasy001 0000&gt;, &lt;OwnerLicence: vasy002 0001&gt;, &lt;OwnerLicence: vasy003 0002&gt;, &lt;OwnerLicence: vasy004 0003&gt;, &lt;OwnerLicence: vasy005 0004&gt;, &lt;OwnerLicence: vasy006 0005&gt;]&gt;
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../lab2/forms/" class="btn btn-neutral float-left" title="forms"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../api_description/" class="btn btn-neutral float-right" title="Описание API">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../lab2/forms/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../api_description/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
